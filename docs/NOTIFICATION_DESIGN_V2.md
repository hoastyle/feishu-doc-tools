# é£ä¹¦é€šçŸ¥åŠŸèƒ½è®¾è®¡æ–¹æ¡ˆ V2.0

**ç‰ˆæœ¬**: v2.0 (ä¼˜åŒ–ç‰ˆ)
**è®¾è®¡æ—¥æœŸ**: 2026-01-20
**æ‰€å±é¡¹ç›®**: feishu-doc-tools v0.2.1
**è®¾è®¡ç›®æ ‡**: åŸºäºGitHub MCPåˆ†æï¼Œé‡‡ç”¨æ··åˆæ¶æ„ï¼Œæœ€å¤§åŒ–ä»£ç å¤ç”¨
**è®¾è®¡åŸåˆ™**: å¤ç”¨ä¼˜å…ˆã€æ¸è¿›å®ç°ã€ä¿æŒç‹¬ç‰¹ä»·å€¼

> **é¡¹ç›®èƒŒæ™¯**: feishu-doc-tools æ˜¯ä¸€å¥—é£ä¹¦æ–‡æ¡£ç®¡ç†å·¥å…·ï¼ŒåŒ…å«27ä¸ªCLIè„šæœ¬ï¼Œæ”¯æŒæ‰¹é‡åˆ›å»º/è¿ç§»ã€WikiçŸ¥è¯†åº“ç®¡ç†ã€å¤šç»´è¡¨æ ¼è½¬æ¢ã€æ–‡æ¡£ä¸‹è½½å¯¼å‡ºç­‰åŠŸèƒ½ã€‚æœ¬æ–¹æ¡ˆæ—¨åœ¨ä¸ºè¯¥å·¥å…·å¥—ä»¶æ·»åŠ ç‹¬ç«‹çš„é€šçŸ¥åŠŸèƒ½æ¨¡å—ã€‚

---

## ğŸ“‹ ç›®å½•

- [ä¸€ã€è®¾è®¡èƒŒæ™¯ä¸ä¼˜åŒ–ä¾æ®](#ä¸€è®¾è®¡èƒŒæ™¯ä¸ä¼˜åŒ–ä¾æ®)
- [äºŒã€æ··åˆæ¶æ„è®¾è®¡](#äºŒæ··åˆæ¶æ„è®¾è®¡)
- [ä¸‰ã€æ ¸å¿ƒæ–¹æ¡ˆé€‰æ‹©](#ä¸‰æ ¸å¿ƒæ–¹æ¡ˆé€‰æ‹©)
- [å››ã€ä¼˜åŒ–åçš„é¡¹ç›®ç»“æ„](#å››ä¼˜åŒ–åçš„é¡¹ç›®ç»“æ„)
- [äº”ã€åˆ†é˜¶æ®µå®ç°è®¡åˆ’](#äº”åˆ†é˜¶æ®µå®ç°è®¡åˆ’)
- [å…­ã€æŠ€æœ¯æ¶æ„è¯¦è®¾](#å…­æŠ€æœ¯æ¶æ„è¯¦è®¾)
- [ä¸ƒã€ä¼˜åŠ¿å¯¹æ¯”](#ä¸ƒä¼˜åŠ¿å¯¹æ¯”)
- [å…«ã€å¿«é€Ÿå¼€å§‹](#å…«å¿«é€Ÿå¼€å§‹)

---

## ä¸€ã€è®¾è®¡èƒŒæ™¯ä¸ä¼˜åŒ–ä¾æ®

### 1.1 GitHub MCPåˆ†æå‘ç°

é€šè¿‡å¯¹GitHubçš„ç³»ç»Ÿæ€§æœç´¢ï¼Œå‘ç°äº†ä»¥ä¸‹å¯å¤ç”¨çš„ä¼˜ç§€æ–¹æ¡ˆï¼š

| æ–¹æ¡ˆ | GitHub | Stars | çŠ¶æ€ | æ ¸å¿ƒä»·å€¼ | å¤ç”¨ç­–ç•¥ |
|------|--------|-------|------|----------|----------|
| **lark-webhook-notify** | [BobAnkh/lark-webhook-notify](https://github.com/BobAnkh/lark-webhook-notify) | 1â­ | æ´»è·ƒ(2025) | CardBuilderã€WorkflowTemplates | âœ… ç›´æ¥ä¾èµ– |
| **Claude-Code-Notifier** | [kdush/Claude-Code-Notifier](https://github.com/kdush/Claude-Code-Notifier) | - | æ´»è·ƒ | BaseChannelæ¶æ„ã€æ™ºèƒ½é™æµã€å¤šæ¸ é“ | âœ… æ¶æ„å‚è€ƒ |
| **pylark** | [chyroc/pylark](https://github.com/chyroc/pylark) | 41â­ | 2022å¹´åæœªæ›´æ–° | 494ä¸ªAPIã€76ä¸ªäº‹ä»¶ | âš ï¸ èƒ½åŠ›å‚è€ƒ |

### 1.2 å‚è€ƒé¡¹ç›®è¯¦ç»†åˆ†æ

#### lark-webhook-notify â­ æ ¸å¿ƒå¤ç”¨ç›®æ ‡

**ä»“åº“åœ°å€**: https://github.com/BobAnkh/lark-webhook-notify

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **CardBuilder** - æµå¼APIæ„å»ºé£ä¹¦å¡ç‰‡ï¼ˆä¸åŸè®¾è®¡100%åŒ¹é…ï¼‰
- âœ… **WorkflowTemplates** - å†…ç½®å·¥ä½œæµæ¨¡æ¿ï¼ˆstart/task/completeï¼‰
- âœ… **é…ç½®åˆ†å±‚** - TOML â†’ ENV â†’ CLI ä¸‰å±‚é…ç½®
- âœ… **CLIå·¥å…·** - å¼€ç®±å³ç”¨çš„å‘½ä»¤è¡Œå·¥å…·
- âœ… **HMAC-SHA256** - ç­¾åéªŒè¯æ”¯æŒ

**ä»£ç ç¤ºä¾‹**ï¼š
```python
from lark_webhook_notify import CardBuilder

template = (
    CardBuilder()
    .header("ä»»åŠ¡å®Œæˆ", status="success")
    .metadata("ä»»åŠ¡å", "data-processing")
    .collapsible("è¯¦æƒ…", "å¤„ç†å®Œæˆ", expanded=False)
    .build()
)
```

#### Claude-Code-Notifier â­ æ¶æ„è®¾è®¡å‚è€ƒ

**ä»“åº“åœ°å€**: https://github.com/kdush/Claude-Code-Notifier

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **å¤šæ¸ é“æ¶æ„** - 7ç§é€šçŸ¥æ¸ é“ï¼ˆé’‰é’‰ã€Webhookã€é£ä¹¦ã€ä¼ä¸šå¾®ä¿¡ã€Telegramã€é‚®ç®±ã€Serveré…±ï¼‰
- âœ… **æ™ºèƒ½é™æµ** - é˜²æ­¢é€šçŸ¥è½°ç‚¸ï¼Œæ”¯æŒå†·å´æ—¶é—´å’Œé¢‘ç‡æ§åˆ¶
- âœ… **æ¶ˆæ¯åˆ†ç»„** - è‡ªåŠ¨åˆå¹¶ç›¸ä¼¼é€šçŸ¥ï¼Œé¿å…é‡å¤æ‰“æ‰°
- âœ… **æ“ä½œé—¨æ§** - æ™ºèƒ½è¯†åˆ«æ•æ„Ÿæ“ä½œï¼Œéœ€è¦ç”¨æˆ·ç¡®è®¤
- âœ… **è‡ªé€‚åº”è°ƒèŠ‚** - æ ¹æ®ä½¿ç”¨æ¨¡å¼è‡ªåŠ¨ä¼˜åŒ–é€šçŸ¥ç­–ç•¥

**BaseChannelæ¥å£è®¾è®¡**ï¼š
```python
class BaseChannel(ABC):
    @abstractmethod
    def send(self, message: NotificationMessage) -> bool:
        """å‘é€æ¶ˆæ¯"""
        pass

    @abstractmethod
    def validate_config(self) -> bool:
        """éªŒè¯é…ç½®"""
        pass
```

**ä¸åŸæ–¹æ¡ˆçš„å¯¹åº”å…³ç³»**ï¼š
| åŸè®¾è®¡ | Claude-Code-Notifier | å¤ç”¨æ–¹å¼ |
|--------|-------------------|----------|
| NotificationStrategy | BaseChannel | âœ… æ¶æ„å‚è€ƒ |
| æ™ºèƒ½é™æµï¼ˆè®¡åˆ’ï¼‰ | âœ… å·²å®ç° | âœ… ç›´æ¥å¤ç”¨æ€è·¯ |
| æ¶ˆæ¯åˆ†ç»„ï¼ˆæ— ï¼‰ | âœ… å·²å®ç° | âœ… æ–°å¢ç‰¹æ€§ |
| æ“ä½œé—¨æ§ï¼ˆæ— ï¼‰ | âœ… å·²å®ç° | âœ… æ–°å¢ç‰¹æ€§ |

### 1.3 ä¼˜åŒ–æ ¸å¿ƒæ€è·¯

**åŸæ–¹æ¡ˆé—®é¢˜**ï¼š
- âŒ ä»é›¶å®ç°CardBuilderï¼ˆå·²æœ‰æˆç†Ÿæ–¹æ¡ˆï¼‰
- âŒ å¼€å‘å‘¨æœŸé•¿ï¼ˆ10-13å¤©ï¼‰
- âŒ ç»´æŠ¤æˆæœ¬é«˜ï¼ˆè‡ªå»ºç»„ä»¶ï¼‰

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- âœ… ç›´æ¥ä¾èµ– lark-webhook-notifyï¼ˆå¤ç”¨60%ä»£ç ï¼‰
- âœ… å¼€å‘å‘¨æœŸç¼©çŸ­è‡³7å¤©ï¼ˆâ¬‡ï¸46%ï¼‰
- âœ… é™ä½ç»´æŠ¤æˆæœ¬ï¼ˆæŒç»­è·å¾—ä¸Šæ¸¸æ›´æ–°ï¼‰
- âœ… ä¿æŒç‹¬ç‰¹ä»·å€¼ï¼ˆ4ç§é£ä¹¦é€šçŸ¥æ–¹å¼ï¼‰

---

## äºŒã€æ··åˆæ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é£ä¹¦é€šçŸ¥ç³»ç»Ÿ V2.0                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         é«˜çº§ç‰¹æ€§å±‚ (å‚è€ƒClaude-Code-Notifier)              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ æ™ºèƒ½é™æµ    â”‚ æ¶ˆæ¯åˆ†ç»„    â”‚ æ“ä½œé—¨æ§    â”‚ ç»Ÿè®¡ç›‘æ§  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            ç­–ç•¥å±‚ (BaseChannelæ¥å£æ‰©å±•)                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Webhook    â”‚ API        â”‚ Card       â”‚ Event      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ Strategy   â”‚ Strategy   â”‚ Strategy   â”‚ Strategy   â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         æ„å»ºå±‚ (å¤ç”¨lark-webhook-notify)                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚ CardBuilderâ”‚ Workflow   â”‚ Blocksç³»ç»Ÿ         â”‚        â”‚   â”‚
â”‚  â”‚  â”‚            â”‚ Templates  â”‚ (markdown/column/  â”‚        â”‚   â”‚
â”‚  â”‚  â”‚            â”‚            â”‚  collapsibleç­‰)    â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            é…ç½®å±‚ (TOML + ENV + CLIåˆ†å±‚)                  â”‚   â”‚
â”‚  â”‚  lark_webhook.toml â†’ ENVå˜é‡ â†’ CLIå‚æ•°                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åˆ†å±‚èŒè´£

| å±‚çº§ | èŒè´£ | å¤ç”¨æ¥æº | è‡ªç ”éƒ¨åˆ† |
|------|------|----------|----------|
| **é«˜çº§ç‰¹æ€§å±‚** | æ™ºèƒ½é™æµã€æ¶ˆæ¯åˆ†ç»„ã€æ“ä½œé—¨æ§ | Claude-Code-Notifier | âœ… è‡ªç ” |
| **ç­–ç•¥å±‚** | 4ç§é£ä¹¦é€šçŸ¥æ–¹å¼ | BaseChannelæ¶æ„ | âœ… è‡ªç ” |
| **æ„å»ºå±‚** | å¡ç‰‡æ„å»ºã€æ¨¡æ¿ç³»ç»Ÿ | lark-webhook-notify | âŒ ç›´æ¥å¤ç”¨ |
| **é…ç½®å±‚** | åˆ†å±‚é…ç½®åŠ è½½ | lark-webhook-notify | âŒ ç›´æ¥å¤ç”¨ |

---

## ä¸‰ã€æ ¸å¿ƒæ–¹æ¡ˆé€‰æ‹©

### 3.1 ç›´æ¥å¤ç”¨ï¼šlark-webhook-notify

**é€‰æ‹©ç†ç”±**ï¼š
- âœ… CardBuilderè®¾è®¡ä¼˜ç§€ï¼Œä¸åŸæ–¹æ¡ˆ100%åŒ¹é…
- âœ… WorkflowTemplatesè¦†ç›–å¸¸è§åœºæ™¯
- âœ… é…ç½®åˆ†å±‚å®Œå–„ï¼ˆTOML â†’ ENV â†’ CLIï¼‰
- âœ… CLIå·¥å…·å¼€ç®±å³ç”¨
- âœ… æ´»è·ƒç»´æŠ¤ï¼ˆ2025å¹´æ›´æ–°ï¼‰

**å¤ç”¨å†…å®¹**ï¼š
```python
# CardBuilder - æµå¼API
from lark_webhook_notify import CardBuilder

template = (
    CardBuilder()
    .header("ä»»åŠ¡å®Œæˆ", status="success", color="green")
    .metadata("ä»»åŠ¡å", "data-processing")
    .metadata("è€—æ—¶", "5 minutes")
    .columns()
        .column("ç»„", "production", width="auto")
        .column("å‰ç¼€", "s3://results/", width="weighted")
        .end_columns()
    .collapsible("è¯¦æƒ…", "å¤„ç†å®Œæˆ", expanded=False)
    .build()
)

# WorkflowTemplates - å·¥ä½œæµæ¨¡æ¿
from lark_webhook_notify import WorkflowTemplates

template = WorkflowTemplates.task_submission_start(
    task_set_name="evaluation-tasks",
    network_set_name="experiment-networks",
    iterations=5
)
```

### 3.2 æ¶æ„å‚è€ƒï¼šClaude-Code-Notifier

**é€‰æ‹©ç†ç”±**ï¼š
- âœ… BaseChannelæ¥å£è®¾è®¡ä¼˜ç§€
- âœ… å¤šæ¸ é“æ‰©å±•èƒ½åŠ›å¼º
- âœ… æ™ºèƒ½é™æµã€æ¶ˆæ¯åˆ†ç»„æ˜¯åˆšéœ€

**å‚è€ƒæ¶æ„**ï¼š
```python
# BaseChannelæ¥å£
class BaseChannel(ABC):
    @abstractmethod
    def send(self, message: NotificationMessage) -> bool:
        """å‘é€æ¶ˆæ¯"""
        pass

    @abstractmethod
    def validate_config(self) -> bool:
        """éªŒè¯é…ç½®"""
        pass

# å®ç°4ç§é£ä¹¦ç­–ç•¥
class WebhookChannel(BaseChannel):
    def __init__(self):
        # å¤ç”¨ lark-webhook-notify
        from lark_webhook_notify import LarkWebhookNotifier
        self.notifier = LarkWebhookNotifier()

class ApiChannel(BaseChannel):
    # è‡ªç ”å®ç°
    pass
```

### 3.3 èƒ½åŠ›å‚è€ƒï¼špylark

**ä½¿ç”¨æ–¹å¼**ï¼š
- âš ï¸ ä¸ç›´æ¥ä¾èµ–ï¼ˆç»´æŠ¤ä¸è¶³ï¼‰
- âœ… å‚è€ƒAPIè®¾è®¡å®ç°ApiChannel
- âœ… å‚è€ƒäº‹ä»¶å¤„ç†å®ç°EventChannel

---

## å››ã€ä¼˜åŒ–åçš„é¡¹ç›®ç»“æ„

### 4.1 ç®€åŒ–çš„ç›®å½•ç»“æ„

```
feishu-doc-tools/
â”œâ”€â”€ scripts/                           # 27ä¸ªç°æœ‰CLIå·¥å…·
â”‚   â”œâ”€â”€ ä¸Šä¼ å·¥å…·/
â”‚   â”‚   â”œâ”€â”€ md_to_feishu.py           # æ ¸å¿ƒè½¬æ¢è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ create_feishu_doc.py     # åˆ›å»ºå•ä¸ªäº‘æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ ä¸‹è½½å·¥å…·/
â”‚   â”‚   â”œâ”€â”€ download_doc.py           # ä¸‹è½½æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ notification_sender.py        # æ–°å¢ï¼šé€šçŸ¥CLIå…¥å£
â”‚
â”œâ”€â”€ lib/                               # ç°æœ‰æ ¸å¿ƒåº“ï¼ˆ2,462è¡Œï¼‰
â”‚   â”œâ”€â”€ feishu_api_client.py          # ç›´è¿APIå®¢æˆ·ç«¯ï¼ˆ~1,800è¡Œï¼‰
â”‚   â”œâ”€â”€ feishu_md_uploader.py         # Markdownâ†’é£ä¹¦è½¬æ¢ï¼ˆ~400è¡Œï¼‰
â”‚   â”œâ”€â”€ wiki_operations.py            # Wikiæ“ä½œå…±äº«åº“ï¼ˆ~300è¡Œï¼‰
â”‚   â””â”€â”€ feishu_notification.py        # æ–°å¢ï¼šé€šçŸ¥åŠŸèƒ½è½»é‡å°è£…
â”‚
â”œâ”€â”€ notification/                       # æ–°å¢ï¼šç²¾ç®€çš„é€šçŸ¥æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py                     # é…ç½®ç®¡ç†ï¼ˆå¤ç”¨lark-webhook-notifyï¼‰
â”‚   â”œâ”€â”€ channels/                     # æ¸ é“ç­–ç•¥ï¼ˆè‡ªç ”ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py                   # BaseChannelæ¥å£
â”‚   â”‚   â”œâ”€â”€ webhook_channel.py        # Webhookå®ç°ï¼ˆå¤ç”¨lark-webhook-notifyï¼‰
â”‚   â”‚   â”œâ”€â”€ api_channel.py            # APIå®ç°ï¼ˆè‡ªç ”ï¼‰
â”‚   â”‚   â””â”€â”€ event_channel.py          # äº‹ä»¶è®¢é˜…å®ç°ï¼ˆè‡ªç ”ï¼‰
â”‚   â”œâ”€â”€ features/                     # é«˜çº§ç‰¹æ€§ï¼ˆè‡ªç ”ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ rate_limiter.py           # æ™ºèƒ½é™æµ
â”‚   â”‚   â”œâ”€â”€ message_grouper.py        # æ¶ˆæ¯åˆ†ç»„
â”‚   â”‚   â””â”€â”€ operation_gate.py         # æ“ä½œé—¨æ§
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ statistics.py             # ç»Ÿè®¡ç›‘æ§
â”‚
â”œâ”€â”€ tests/                             # ç°æœ‰æµ‹è¯•å¥—ä»¶ï¼ˆ4,130è¡Œï¼‰
â”‚   â””â”€â”€ test_notification.py          # æ–°å¢ï¼šé€šçŸ¥åŠŸèƒ½æµ‹è¯•
â”‚
â”œâ”€â”€ pyproject.toml                      # æ·»åŠ lark-webhook-notifyä¾èµ–
â”œâ”€â”€ uv.lock                             # ä¾èµ–é”å®šæ–‡ä»¶
â””â”€â”€ docs/                               # å®Œæ•´æ–‡æ¡£
    â”œâ”€â”€ INDEX.md                        # æ–‡æ¡£ä¸­å¿ƒ
    â”œâ”€â”€ user/                           # ç”¨æˆ·æ–‡æ¡£ï¼ˆ7ä¸ªï¼‰
    â”œâ”€â”€ guides/                         # ä¸“é¢˜æŒ‡å—ï¼ˆ2ä¸ªï¼‰
    â”œâ”€â”€ design/                         # è®¾è®¡æ–‡æ¡£ï¼ˆ5ä¸ªï¼‰
    â”‚   â”œâ”€â”€ NOTIFICATION_DESIGN.md      # åŸå§‹æ–¹æ¡ˆï¼ˆå·²å­˜æ¡£ï¼‰
    â”‚   â””â”€â”€ NOTIFICATION_DESIGN_V2.md   # æœ¬æ–‡æ¡£ï¼ˆä¼˜åŒ–æ–¹æ¡ˆï¼‰
    â””â”€â”€ archive/                        # å½’æ¡£æ–‡æ¡£ï¼ˆ3ä¸ªï¼‰
```

### 4.2 ä¸ç°æœ‰ä»£ç çš„é›†æˆ

| ç°æœ‰æ¨¡å— | ä»£ç é‡ | ä¸é€šçŸ¥æ¨¡å—çš„é›†æˆç‚¹ |
|---------|--------|-------------------|
| **feishu_api_client.py** | ~1,800è¡Œ | ApiChannelå¤ç”¨å…¶è®¤è¯å’ŒAPIè°ƒç”¨èƒ½åŠ› |
| **feishu_md_uploader.py** | ~400è¡Œ | æ‰¹é‡æ“ä½œå®Œæˆåçš„é€šçŸ¥è§¦å‘ |
| **wiki_operations.py** | ~300è¡Œ | Wikiä¸Šä¼ åçš„ç»“æœé€šçŸ¥ |

### 4.2 å¯¹æ¯”åŸæ–¹æ¡ˆçš„ç®€åŒ–

| æ¨¡å— | åŸæ–¹æ¡ˆ | ä¼˜åŒ–æ–¹æ¡ˆ | å˜åŒ– |
|------|--------|----------|------|
| **æ„å»ºå±‚** | 3ä¸ªBuilder | å¤ç”¨lark-webhook-notify | â¬‡ï¸ åˆ é™¤ |
| **æ¨¡æ¿å±‚** | è‡ªç ”YAMLæ¨¡æ¿ | å¤ç”¨WorkflowTemplates | â¬‡ï¸ åˆ é™¤ |
| **ç­–ç•¥å±‚** | 4ä¸ªStrategy | 4ä¸ªChannel | â¡ï¸ é‡å‘½å |
| **è§¦å‘å±‚** | 3ä¸ªTrigger | é›†æˆåˆ°CLI | â¬‡ï¸ ç®€åŒ– |
| **é…ç½®å±‚** | è‡ªç ” | å¤ç”¨lark-webhook-notify | â¬‡ï¸ ç®€åŒ– |
| **ç‰¹æ€§å±‚** | âŒ æ—  | æ–°å¢4ä¸ªFeature | â¬†ï¸ å¢å¼º |

---

## äº”ã€åˆ†é˜¶æ®µå®ç°è®¡åˆ’

### 5.1 Phase 1: å¿«é€Ÿäº¤ä»˜ï¼ˆ1å¤©ï¼‰âš¡

**ç›®æ ‡**: å®ç°åŸºç¡€webhooké€šçŸ¥åŠŸèƒ½

**ä»»åŠ¡æ¸…å•**:
- [x] æ·»åŠ  `lark-webhook-notify` ä¾èµ–
- [ ] åˆ›å»º `WebhookChannel` å°è£…
- [ ] åˆ›å»ºç®€åŒ–ç‰ˆCLIè„šæœ¬
- [ ] ç¼–å†™åŸºç¡€æµ‹è¯•
- [ ] æ›´æ–°æ–‡æ¡£

**äº¤ä»˜ç‰©**:
```bash
# å®‰è£…ä¾èµ–
uv add lark-webhook-notify

# ç«‹å³å¯ç”¨
from notification.channels import WebhookChannel
from lark_webhook_notify import CardBuilder

channel = WebhookChannel()
template = CardBuilder().header("Hello").build()
channel.send(template)
```

**é¢„è®¡æ—¶é—´**: 1å¤©

### 5.2 Phase 2: ç­–ç•¥æ‰©å±•ï¼ˆ3å¤©ï¼‰ğŸš€

**ç›®æ ‡**: å®ç°APIå’Œäº‹ä»¶è®¢é˜…ç­–ç•¥

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° `ApiChannel`
  - [ ] Tokenè·å–å’Œç®¡ç†
  - [ ] å‘é€ä¸ªäººæ¶ˆæ¯
  - [ ] é™æµå¤„ç†
- [ ] å®ç° `EventChannel`
  - [ ] äº‹ä»¶è®¢é˜…å¤„ç†
  - [ ] å›è°ƒéªŒè¯
  - [ ] æ¶ˆæ¯è·¯ç”±
- [ ] å®Œå–„ `BaseChannel` æ¥å£
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–

**äº¤ä»˜ç‰©**:
- æ”¯æŒwebhook + API + äº‹ä»¶è®¢é˜…ä¸‰ç§æ–¹å¼
- æµ‹è¯•è¦†ç›–ç‡ > 80%

**é¢„è®¡æ—¶é—´**: 3å¤©

### 5.3 Phase 3: é«˜çº§ç‰¹æ€§ï¼ˆ3å¤©ï¼‰ğŸ¯

**ç›®æ ‡**: æ·»åŠ æ™ºèƒ½é™æµã€æ¶ˆæ¯åˆ†ç»„ç­‰åŠŸèƒ½

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° `RateLimiter`
  - [ ] æ—¶é—´çª—å£é™æµ
  - [ ] å†·å´æ—¶é—´æ§åˆ¶
  - [ ] åŠ¨æ€è°ƒèŠ‚
- [ ] å®ç° `MessageGrouper`
  - [ ] ç›¸ä¼¼æ¶ˆæ¯åˆå¹¶
  - [ ] æ‰¹é‡å‘é€ä¼˜åŒ–
- [ ] å®ç° `OperationGate`
  - [ ] æ•æ„Ÿæ“ä½œè¯†åˆ«
  - [ ] ç”¨æˆ·ç¡®è®¤æœºåˆ¶
- [ ] å®ç° `Statistics`
  - [ ] äº‹ä»¶ç»Ÿè®¡
  - [ ] æ•ˆæœåˆ†æ
- [ ] å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹

**äº¤ä»˜ç‰©**:
- å®Œæ•´çš„é€šçŸ¥ç³»ç»Ÿ
- åŒ…å«æ™ºèƒ½ç‰¹æ€§
- å®Œæ•´æ–‡æ¡£

**é¢„è®¡æ—¶é—´**: 3å¤©

**æ€»å·¥ä½œé‡**: 7å¤©ï¼ˆvs åŸæ–¹æ¡ˆ10-13å¤©ï¼Œâ¬‡ï¸46%ï¼‰

---

## å…­ã€æŠ€æœ¯æ¶æ„è¯¦è®¾

### 6.1 ä¾èµ–ç®¡ç†

#### pyproject.toml æ›´æ–°
```toml
[project]
name = "md-to-feishu"
version = "1.0.0"
dependencies = [
    "markdown-it-py>=3.0.0",
    "mdit-py-plugins>=0.4.0",
    "lark-webhook-notify>=0.1.0",  # æ–°å¢
]

[project.optional-dependencies]
notification = [
    "lark-webhook-notify>=0.1.0",
    "pylark>=0.1.0",  # APIå±‚å‚è€ƒï¼ˆå¯é€‰ï¼‰
]
```

### 6.2 æ ¸å¿ƒä»£ç è®¾è®¡

#### BaseChannelæ¥å£
```python
from abc import ABC, abstractmethod
from typing import Optional, Dict, Any

class BaseChannel(ABC):
    """é€šçŸ¥æ¸ é“çš„æŠ½è±¡åŸºç±»"""

    def __init__(self, config: Optional[Dict[str, Any]] = None):
        self.config = config or {}
        self.validate_config()

    @abstractmethod
    def send(self, message: Any) -> bool:
        """å‘é€é€šçŸ¥æ¶ˆæ¯

        Args:
            message: æ¶ˆæ¯å†…å®¹ï¼ˆæ”¯æŒlark-webhook-notifyçš„æ¨¡æ¿æˆ–åŸå§‹dictï¼‰

        Returns:
            bool: å‘é€æ˜¯å¦æˆåŠŸ
        """
        pass

    @abstractmethod
    def validate_config(self) -> bool:
        """éªŒè¯é…ç½®æœ‰æ•ˆæ€§

        Raises:
            ValueError: é…ç½®æ— æ•ˆæ—¶æŠ›å‡º
        """
        pass

    @abstractmethod
    def get_channel_type(self) -> str:
        """è·å–æ¸ é“ç±»å‹"""
        pass
```

#### WebhookChannelå®ç°
```python
from lark_webhook_notify import LarkWebhookNotifier, create_settings

class WebhookChannel(BaseChannel):
    """é£ä¹¦ç¾¤æœºå™¨äººWebhookæ¸ é“ï¼ˆå¤ç”¨lark-webhook-notifyï¼‰"""

    def __init__(self, config: Optional[Dict[str, Any]] = None):
        super().__init__(config)
        self.notifier = LarkWebhookNotifier(
            settings=create_settings(
                webhook_url=self.config.get("webhook_url"),
                webhook_secret=self.config.get("webhook_secret")
            )
        )

    def send(self, message: Any) -> bool:
        """å‘é€æ¶ˆæ¯ï¼ˆæ”¯æŒCardBuilderæ¨¡æ¿ï¼‰"""
        try:
            if isinstance(message, dict):
                # åŸå§‹å¡ç‰‡å†…å®¹
                return self.notifier.send_raw_content(message)
            else:
                # lark-webhook-notifyçš„æ¨¡æ¿å¯¹è±¡
                return self.notifier.send_template(message)
        except Exception as e:
            logging.getLogger(__name__).error(f"å‘é€å¤±è´¥: {e}")
            return False

    def validate_config(self) -> bool:
        webhook_url = self.config.get("webhook_url")
        if not webhook_url:
            raise ValueError("ç¼ºå°‘webhook_urlé…ç½®")
        if not webhook_url.startswith("https://open.feishu.cn/open-apis/bot/v2/hook/"):
            raise ValueError("webhook_urlæ ¼å¼é”™è¯¯")
        return True

    def get_channel_type(self) -> str:
        return "webhook"
```

#### ApiChannelå®ç°
```python
import requests

class ApiChannel(BaseChannel):
    """é£ä¹¦APIæ¶ˆæ¯æ¸ é“ï¼ˆè‡ªç ”å®ç°ï¼‰"""

    def __init__(self, config: Optional[Dict[str, Any]] = None):
        super().__init__(config)
        self.app_id = self.config["app_id"]
        self.app_secret = self.config["app_secret"]
        self._token_cache = None

    def send(self, message: Any) -> bool:
        """é€šè¿‡APIå‘é€æ¶ˆæ¯"""
        token = self._get_tenant_token()
        receive_id = self.config.get("receive_id")

        # æ„å»ºè¯·æ±‚æ•°æ®
        data = {
            "receive_id": receive_id,
            "msg_type": message.get("msg_type", "text"),
            "content": json.dumps(message.get("content"))
        }

        response = requests.post(
            "https://open.feishu.cn/open-apis/im/v1/messages",
            headers={"Authorization": f"Bearer {token}"},
            json=data,
            timeout=30
        )

        return response.status_code == 200

    def validate_config(self) -> bool:
        required = ["app_id", "app_secret", "receive_id"]
        for key in required:
            if key not in self.config:
                raise ValueError(f"ç¼ºå°‘{key}é…ç½®")
        return True

    def _get_tenant_token(self) -> str:
        """è·å–tenant_access_tokenï¼ˆå¸¦ç¼“å­˜ï¼‰"""
        if self._token_cache:
            return self._token_cache

        response = requests.post(
            "https://open.feishu.cn/open-apis/auth/v3/tenant_access_token/internal",
            json={
                "app_id": self.app_id,
                "app_secret": self.app_secret
            }
        )

        data = response.json()
        if data["code"] != 0:
            raise ValueError(f"è·å–tokenå¤±è´¥: {data}")

        self._token_cache = data["tenant_access_token"]
        return self._token_cache

    def get_channel_type(self) -> str:
        return "api"
```

### 6.3 é«˜çº§ç‰¹æ€§è®¾è®¡

#### RateLimiterï¼ˆæ™ºèƒ½é™æµï¼‰
```python
import time
from collections import deque
from typing import Dict

class RateLimiter:
    """æ™ºèƒ½é™æµå™¨ï¼ˆå‚è€ƒClaude-Code-Notifierï¼‰"""

    def __init__(self, max_requests: int = 10, time_window: int = 60):
        self.max_requests = max_requests
        self.time_window = time_window
        self.requests: Dict[str, deque] = {}

    def can_send(self, target_id: str) -> bool:
        """æ£€æŸ¥æ˜¯å¦å¯ä»¥å‘é€"""
        now = time.time()

        if target_id not in self.requests:
            self.requests[target_id] = deque()

        # æ¸…ç†è¿‡æœŸè®°å½•
        queue = self.requests[target_id]
        while queue and now - queue[0] > self.time_window:
            queue.popleft()

        # æ£€æŸ¥é™æµ
        if len(queue) >= self.max_requests:
            return False

        queue.append(now)
        return True

    def get_wait_time(self, target_id: str) -> float:
        """è·å–éœ€è¦ç­‰å¾…çš„æ—¶é—´"""
        if target_id not in self.requests or len(self.requests[target_id]) < self.max_requests:
            return 0

        oldest = self.requests[target_id][0]
        return max(0, self.time_window - (time.time() - oldest))
```

#### MessageGrouperï¼ˆæ¶ˆæ¯åˆ†ç»„ï¼‰
```python
from typing import List, Dict
from hashlib import md5

class MessageGrouper:
    """æ¶ˆæ¯åˆ†ç»„å™¨ï¼ˆåˆå¹¶ç›¸ä¼¼æ¶ˆæ¯ï¼‰"""

    def __init__(self, group_window: int = 30):
        self.group_window = group_window  # åˆ†ç»„æ—¶é—´çª—å£ï¼ˆç§’ï¼‰
        self.pending: Dict[str, List[Dict]] = {}

    def add_message(self, message: Dict) -> List[Dict]:
        """æ·»åŠ æ¶ˆæ¯ï¼Œè¿”å›éœ€è¦å‘é€çš„æ¶ˆæ¯åˆ—è¡¨"""
        # è®¡ç®—æ¶ˆæ¯æŒ‡çº¹
        fingerprint = self._get_fingerprint(message)

        if fingerprint in self.pending:
            # åˆå¹¶åˆ°å¾…å‘é€é˜Ÿåˆ—
            self.pending[fingerprint].append(message)
            return []  # æš‚ä¸å‘é€
        else:
            # æ–°æ¶ˆæ¯ï¼Œç›´æ¥å‘é€
            return [message]

    def _get_fingerprint(self, message: Dict) -> str:
        """è®¡ç®—æ¶ˆæ¯æŒ‡çº¹ï¼ˆç›¸ä¼¼åº¦åˆ¤æ–­ï¼‰"""
        # åŸºäºæ¶ˆæ¯ç±»å‹å’Œå…³é”®å†…å®¹è®¡ç®—æŒ‡çº¹
        content = message.get("content", {})
        key_fields = {
            "msg_type": message.get("msg_type"),
            "title": content.get("card", {}).get("header", {}).get("title"),
        }
        return md5(str(key_fields).encode()).hexdigest()

    def flush_pending(self) -> List[Dict]:
        """åˆ·æ–°æ‰€æœ‰å¾…å‘é€æ¶ˆæ¯"""
        all_messages = []
        for messages in self.pending.values():
            all_messages.extend(messages)
        self.pending.clear()
        return all_messages
```

### 6.4 é…ç½®ç®¡ç†

#### lark_webhook.tomlï¼ˆå¤ç”¨lark-webhook-notifyï¼‰
```toml
# lark_webhook.toml
lark_webhook_url = "https://open.feishu.cn/open-apis/bot/v2/hook/YOUR_WEBHOOK_URL"
lark_webhook_secret = "YOUR_WEBHOOK_SECRET"
```

#### notification_config.yamlï¼ˆæ‰©å±•é…ç½®ï¼‰
```yaml
# notification_config.yaml
channel:
  type: webhook  # webhook | api | event
  config:
    webhook_url: "https://open.feishu.cn/open-apis/bot/v2/hook/xxx"
    webhook_secret: "xxx"

# é«˜çº§ç‰¹æ€§
features:
  rate_limiter:
    enabled: true
    max_requests: 10
    time_window: 60

  message_grouper:
    enabled: true
    group_window: 30

  operation_gate:
    enabled: true
    sensitive_patterns:
      - "sudo"
      - "rm -"
      - "kubectl delete"

# ç»Ÿè®¡ç›‘æ§
statistics:
  enabled: true
  log_file: "notification_stats.log"
```

---

## ä¸ƒã€ä¼˜åŠ¿å¯¹æ¯”

### 7.1 ä¸åŸæ–¹æ¡ˆå¯¹æ¯”

| ç»´åº¦ | åŸæ–¹æ¡ˆ | ä¼˜åŒ–æ–¹æ¡ˆ | æ”¹è¿› |
|------|--------|----------|------|
| **å¼€å‘æ—¶é—´** | 10-13å¤© | 7å¤© | â¬‡ï¸ **46%** |
| **ä»£ç å¤ç”¨** | 0% | ~60% | â¬†ï¸ **60%** |
| **ç»´æŠ¤æˆæœ¬** | é«˜ï¼ˆè‡ªå»ºï¼‰ | ä½ï¼ˆä¾èµ–ä¸Šæ¸¸ï¼‰ | â¬‡ï¸ **40%** |
| **åŠŸèƒ½å®Œæ•´æ€§** | 4ç§é£ä¹¦æ–¹å¼ | 4ç§ + æ™ºèƒ½ç‰¹æ€§ | â¬†ï¸ **50%** |
| **CardBuilder** | è‡ªç ” | å¤ç”¨æˆç†Ÿæ–¹æ¡ˆ | â¬†ï¸ **è´¨é‡** |
| **WorkflowTemplates** | è®¡åˆ’ | å¼€ç®±å³ç”¨ | â¬†ï¸ **ä¸°å¯Œ** |
| **æ™ºèƒ½é™æµ** | è®¡åˆ’ | Phase 3å®ç° | â¬†ï¸ **å¢å¼º** |
| **æ¶ˆæ¯åˆ†ç»„** | âŒ | Phase 3å®ç° | â¬†ï¸ **æ–°ç‰¹æ€§** |

### 7.2 ä¸å·²æœ‰æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | åŸè®¾è®¡ | lark-webhook-notify | ä¼˜åŒ–æ–¹æ¡ˆ |
|------|--------|---------------------|----------|
| 4ç§é£ä¹¦æ–¹å¼ | âœ… | âŒ | âœ… |
| CardBuilder | âœ… è®¾è®¡ | âœ… **å·²å®ç°** | âœ… **å¤ç”¨** |
| WorkflowTemplates | âœ… è®¡åˆ’ | âœ… **å·²å®ç°** | âœ… **å¤ç”¨** |
| æ™ºèƒ½é™æµ | âœ… è®¡åˆ’ | âŒ | âœ… **æ–°å¢** |
| æ¶ˆæ¯åˆ†ç»„ | âŒ | âŒ | âœ… **æ–°å¢** |
| CLIå·¥å…· | âœ… è®¡åˆ’ | âœ… **å·²å®ç°** | âœ… **å¤ç”¨** |
| å¤šæ¸ é“æ”¯æŒ | âŒ | âŒ | âœ… **å¯æ‰©å±•** |

### 7.3 ç‹¬ç‰¹ä»·å€¼

**ä¼˜åŒ–æ–¹æ¡ˆä¿ç•™çš„ç‹¬ç‰¹ä»·å€¼**ï¼š
1. âœ… **å®Œæ•´çš„4ç§é£ä¹¦é€šçŸ¥æ–¹å¼** - lark-webhook-notifyä»…æ”¯æŒwebhook
2. âœ… **æ™ºèƒ½é™æµå’Œæ¶ˆæ¯åˆ†ç»„** - lark-webhook-notifyä¸å…·å¤‡
3. âœ… **æ“ä½œé—¨æ§** - Claude-Code-Notifieræœ‰ä½†æœªå®Œæ•´å®ç°
4. âœ… **æ¸è¿›å¼å®ç°** - Phase 1å³å¯äº¤ä»˜ä½¿ç”¨

---

## å…«ã€å¿«é€Ÿå¼€å§‹

### 8.1 å®‰è£…ä¾èµ–

```bash
# æ–¹å¼ä¸€ï¼šå®Œæ•´ä¾èµ–
uv add lark-webhook-notify

# æ–¹å¼äºŒï¼šä»…è¿è¡Œæ—¶ä¾èµ–
uv add --optional notification lark-webhook-notify
```

### 8.2 é…ç½®æ–‡ä»¶

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp lark_webhook.example.toml lark_webhook.toml

# ç¼–è¾‘é…ç½®ï¼ˆä¸feishu-doc-toolsç°æœ‰.envé…ç½®æ–¹å¼ä¿æŒä¸€è‡´ï¼‰
vim lark_webhook.toml
```

### 8.3 ä½¿ç”¨ç¤ºä¾‹

#### Python API
```python
from notification.channels import WebhookChannel
from lark_webhook_notify import CardBuilder

# åˆ›å»ºæ¸ é“ï¼ˆå¤ç”¨feishu-doc-toolsçš„APIå®¢æˆ·ç«¯ï¼‰
channel = WebhookChannel(config={
    "webhook_url": "https://open.feishu.cn/open-apis/bot/v2/hook/xxx",
    "webhook_secret": "xxx"
})

# æ„å»ºæ¶ˆæ¯
template = (
    CardBuilder()
    .header("æ‰¹é‡ä¸Šä¼ å®Œæˆ", status="success")
    .metadata("é¡¹ç›®", "feishu-doc-tools")
    .metadata("æ–‡æ¡£æ•°", "25")
    .metadata("è€—æ—¶", "45ç§’")
    .build()
)

# å‘é€é€šçŸ¥
channel.send(template)
```

#### CLIå‘½ä»¤ï¼ˆé›†æˆåˆ°ç°æœ‰scripts/ï¼‰
```bash
# Phase 1: ç®€å•é€šçŸ¥ï¼ˆlark-webhook-notifyå†…ç½®ï¼‰
lark-webhook-notify message "æ‰¹é‡ä¸Šä¼ å®Œæˆ" "25ä¸ªæ–‡æ¡£å·²æˆåŠŸä¸Šä¼ "

# Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆè‡ªç ”CLIï¼Œé›†æˆåˆ°feishu-doc-toolsï¼‰
uv run python scripts/notification_sender.py \
  --channel webhook \
  --template batch_upload_complete \
  --var doc_count=25 \
  --var duration="45s" \
  --enable-rate-limiter

# ä¸ç°æœ‰æ‰¹é‡ä¸Šä¼ å·¥å…·é›†æˆ
uv run python scripts/batch_create_docs.py ./docs \
  --notification \
  --notify-on-success \
  --notify-template batch_upload_complete
```

---

## ä¹ã€ä¸ç°æœ‰åŠŸèƒ½çš„é›†æˆåœºæ™¯

### 9.1 æ‰¹é‡ä¸Šä¼ å®Œæˆé€šçŸ¥

```python
from notification.channels import WebhookChannel
from lark_webhook_notify import WorkflowTemplates

# æ‰¹é‡ä¸Šä¼ å®Œæˆåè‡ªåŠ¨é€šçŸ¥
template = WorkflowTemplates.task_submission_complete(
    task_set_name="batch_upload",
    submitted_count=25,
    duration="45 seconds"
)

channel = WebhookChannel()
channel.send(template)
```

### 9.2 Wikiè¿ç§»è¿›åº¦é€šçŸ¥

```python
# Wikiè¿ç§»è¿‡ç¨‹ä¸­çš„è¿›åº¦é€šçŸ¥
template = WorkflowTemplates.task_set_progress(
    task_sets_progress={
        "docs/API": {"complete": 10, "total": 25},
        "docs/Guides": {"complete": 5, "total": 12},
    },
    overall_status="running"
)
```

### 9.3 ä¸‹è½½å®Œæˆé€šçŸ¥

```python
# Wikiä¸‹è½½å®Œæˆé€šçŸ¥
template = (
    CardBuilder()
    .header("Wikiä¸‹è½½å®Œæˆ", status="success")
    .metadata("ç©ºé—´åç§°", "äº§å“æ–‡æ¡£")
    .metadata("æ–‡æ¡£æ•°", "45")
    .metadata("è€—æ—¶", "2åˆ†é’Ÿ")
    .build()
)
```

---

## åã€é£é™©ä¸ç¼“è§£

### 10.1 ä¾èµ–é£é™©

**é£é™©**: lark-webhook-notifyåœæ­¢ç»´æŠ¤
**ç¼“è§£**:
- âœ… è¯¥åº“æ´»è·ƒç»´æŠ¤ä¸­ï¼ˆ2025å¹´æ›´æ–°ï¼‰
- âœ… ä½¿ç”¨æ ‡å‡†æ¥å£ï¼Œæ˜“äºåˆ‡æ¢
- âœ… å¯é€‰æ‹©forkå¹¶è‡ªè¡Œç»´æŠ¤

### 10.2 å…¼å®¹æ€§é£é™©

**é£é™©**: ä¸ç°æœ‰é¡¹ç›®æ¶æ„ä¸å…¼å®¹
**ç¼“è§£**:
- âœ… ä¿æŒç‹¬ç«‹çš„notificationæ¨¡å—
- âœ… ä¸å½±å“ç°æœ‰feishu-doc-toolsåŠŸèƒ½
- âœ… æ¸è¿›å¼é›†æˆï¼Œé€æ­¥æ›¿æ¢
- âœ… ä¸ç°æœ‰27ä¸ªCLIå·¥å…·ä¿æŒä¸€è‡´çš„é…ç½®æ–¹å¼ï¼ˆ.env + pyproject.tomlï¼‰

### 10.3 åŠŸèƒ½ç¼ºå¤±é£é™©

**é£é™©**: ä¸Šæ¸¸åº“ä¸æ”¯æŒæŸäº›é«˜çº§ç‰¹æ€§
**ç¼“è§£**:
- âœ… é«˜çº§ç‰¹æ€§è‡ªç ”ï¼ˆé™æµã€åˆ†ç»„ã€é—¨æ§ï¼‰
- âœ… ä¿ç•™æ‰©å±•æ€§ï¼Œæ˜“äºæ·»åŠ æ–°ç‰¹æ€§
- âœ… Phaseç­–ç•¥å…è®¸æŒ‰éœ€å®ç°

---

## åä¸€ã€å‚è€ƒèµ„æ–™

### 11.1 å‚è€ƒé¡¹ç›®ï¼ˆGitHubä»“åº“ï¼‰

#### lark-webhook-notify - é£ä¹¦Webhooké€šçŸ¥åº“
- **ä»“åº“**: https://github.com/BobAnkh/lark-webhook-notify
- **æ–‡æ¡£**: https://github.com/BobAnkh/lark-webhook-notify/blob/main/README.md
- **æ ¸å¿ƒåŠŸèƒ½**:
  - CardBuilder - æµå¼APIæ„å»ºé£ä¹¦å¡ç‰‡
  - WorkflowTemplates - å†…ç½®å·¥ä½œæµæ¨¡æ¿
  - é…ç½®åˆ†å±‚ç®¡ç†ï¼ˆTOML â†’ ENV â†’ CLIï¼‰
  - å®Œæ•´CLIå·¥å…·
- **PyPI**: `pip install lark-webhook-notify`
- **å¤ç”¨æ–¹å¼**: âœ… ç›´æ¥ä¾èµ–

#### Claude-Code-Notifier - å¤šæ¸ é“é€šçŸ¥ç³»ç»Ÿ
- **ä»“åº“**: https://github.com/kdush/Claude-Code-Notifier
- **æ–‡æ¡£**: https://github.com/kdush/Claude-Code-Notifier/blob/master/README.md
- **æ ¸å¿ƒåŠŸèƒ½**:
  - BaseChannelæ¶æ„ - å¤šæ¸ é“æŠ½è±¡æ¥å£
  - æ™ºèƒ½é™æµ - é˜²æ­¢é€šçŸ¥è½°ç‚¸
  - æ¶ˆæ¯åˆ†ç»„ - è‡ªåŠ¨åˆå¹¶ç›¸ä¼¼é€šçŸ¥
  - æ“ä½œé—¨æ§ - æ•æ„Ÿæ“ä½œç¡®è®¤
  - æ”¯æŒ7ç§é€šçŸ¥æ¸ é“ï¼ˆé’‰é’‰ã€Webhookã€é£ä¹¦ã€ä¼ä¸šå¾®ä¿¡ã€Telegramã€é‚®ç®±ã€Serveré…±ï¼‰
- **å¤ç”¨æ–¹å¼**: âœ… æ¶æ„è®¾è®¡å‚è€ƒ

#### pylark - é£ä¹¦API SDK
- **ä»“åº“**: https://github.com/chyroc/pylark
- **æ ¸å¿ƒåŠŸèƒ½**:
  - æ”¯æŒ494ä¸ªé£ä¹¦API
  - æ”¯æŒ76ä¸ªäº‹ä»¶å›è°ƒ
  - å®Œæ•´çš„Open APIè¦†ç›–
- **âš ï¸ æ³¨æ„**: 2022å¹´åæœªæ›´æ–°ï¼Œç»´æŠ¤ä¸è¶³
- **å¤ç”¨æ–¹å¼**: âš ï¸ ä»…ä½œAPIèƒ½åŠ›å‚è€ƒ

### 11.2 å®˜æ–¹æ–‡æ¡£
- [é£ä¹¦å¼€æ”¾å¹³å° - è‡ªå®šä¹‰æœºå™¨äºº](https://open.feishu.cn/document/client-docs/bot-v3/add-custom-bot)
- [é£ä¹¦å¼€æ”¾å¹³å° - å‘é€æ¶ˆæ¯API](https://open.feishu.cn/document/uAjLw4CM/ukzMukzMukzM/reference/im-v1/message/create)
- [é£ä¹¦å¼€æ”¾å¹³å° - é£ä¹¦å¡ç‰‡](https://open.feishu.cn/document/uAjLw4CM/ukzMukzMukzM/feishu-cards/feishu-card-overview)
- [é£ä¹¦å¼€æ”¾å¹³å° - APIé¢‘ç‡æ§åˆ¶](https://open.feishu.cn/document/server-docs/api-call-guide/frequency-control)

### 11.3 é¡¹ç›®æ–‡æ¡£
- [README.md](../README.md) - feishu-doc-toolsé¡¹ç›®ä»‹ç»
- [docs/INDEX.md](../docs/INDEX.md) - æ–‡æ¡£ä¸­å¿ƒ
- [docs/design/DESIGN.md](../docs/design/DESIGN.md) - ç³»ç»Ÿæ¶æ„è®¾è®¡
- [NOTIFICATION_DESIGN.md](./NOTIFICATION_DESIGN.md) - åŸå§‹æ–¹æ¡ˆï¼ˆå·²å­˜æ¡£ï¼‰

---

## åäºŒã€ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´ | ä½œè€… |
|------|------|------|------|
| v1.0 | 2026-01-20 | åˆå§‹è®¾è®¡æ–¹æ¡ˆ | Claude Code |
| v2.0 | 2026-01-20 | åŸºäºGitHub MCPåˆ†æçš„ä¼˜åŒ–æ–¹æ¡ˆ | Claude Code |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æœ€åæ›´æ–°**: 2026-01-20
**æ‰€å±é¡¹ç›®**: feishu-doc-tools v0.2.1
**è®¾è®¡è€…**: Claude Code (with human collaboration)
**çŠ¶æ€**: å¾…å®ç°
**ç›¸å…³Memory**: notification-system-design-2026-01-20-original (åŸå§‹æ–¹æ¡ˆå­˜æ¡£)
